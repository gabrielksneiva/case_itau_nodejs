<div class="page-header">
  <h2 class="page-title">üë• Gerenciamento de Clientes</h2>
  <button mat-raised-button color="primary" routerLink="/clientes/new">
    <mat-icon>person_add</mat-icon>
    Novo Cliente
  </button>
</div>

<ng-container *ngIf="customers.length > 0; else noClients">
  <div class="customer-grid">
    <mat-card *ngFor="let c of customers; trackBy: trackByCustomer" class="client-card" role="group" aria-label="Card do cliente {{c.name}}">
      <mat-card-header>
        <mat-icon mat-card-avatar color="primary" aria-hidden="true">account_circle</mat-icon>
        <div class="header-text">
          <mat-card-title>{{ c.name }}</mat-card-title>
          <mat-card-subtitle>{{ c.email }}</mat-card-subtitle>
        </div>

        <button mat-icon-button color="warn"
                class="action-delete"
                (click)="openDeleteDialog(c.id, c.name)"
                aria-label="Excluir {{c.name}}"
                matTooltip="Excluir cliente">
          <mat-icon>delete</mat-icon>
        </button>
      </mat-card-header>

      <mat-card-content>
        <div class="saldo-detailed" [attr.aria-label]="'Saldo dispon√≠vel: R$ ' + (c.balance | number:'1.2-2')">
          <div class="saldo-head">
            <div class="saldo-label">Saldo dispon√≠vel</div>

            <button mat-icon-button class="toggle-saldo" (click)="c.balanceOculto = !c.balanceOculto"
                    [attr.aria-pressed]="c.balanceOculto" aria-label="Alternar visibilidade do saldo"
                    matTooltip="Mostrar/ocultar saldo">
              <mat-icon>{{ c.balanceOculto ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
          </div>

          <div class="saldo-value" [ngClass]="{'negative': c.balance < 0}">
            <ng-container *ngIf="!c.balanceOculto; else masked">
              R$ {{ c.balance | number:'1.2-2' }}
            </ng-container>
            <ng-template #masked>R$ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢,‚Ä¢‚Ä¢</ng-template>
          </div>

          <div class="saldo-meta" *ngIf="c.balanceUpdatedAt">
            Atualizado em {{ c.balanceUpdatedAt | date:'dd/MM/yyyy HH:mm' }}
          </div>
        </div>
      </mat-card-content>

      <mat-card-actions class="card-actions">
        <button mat-stroked-button color="accent" [routerLink]="['/clientes', c.id, 'edit']" aria-label="Editar {{c.name}}" matTooltip="Editar cliente">
          <mat-icon>edit</mat-icon>
          Editar
        </button>

        <button mat-stroked-button class="action-deposit" [routerLink]="['/clientes', c.id, 'deposit']" aria-label="Depositar em {{c.name}}" matTooltip="Depositar">
          <mat-icon>arrow_downward</mat-icon>
          Depositar
        </button>

        <button mat-stroked-button class="action-withdraw" [routerLink]="['/clientes', c.id, 'withdraw']" aria-label="Sacar de {{c.name}}" matTooltip="Sacar">
          <mat-icon>arrow_upward</mat-icon>
          Sacar
        </button>

        <button mat-stroked-button class="action-transactions" [routerLink]="['/clientes', c.id, 'transacoes']" aria-label="Transa√ß√µes de {{c.name}}" matTooltip="Listar transa√ß√µes">
          <mat-icon>list</mat-icon>
          Transa√ß√µes
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</ng-container>

<ng-template #noClients>
  <div class="empty-state">
    <mat-icon class="empty-state-icon">people_outline</mat-icon>
    <h2>Nenhum cliente cadastrado</h2>
    <p>Clique em "Novo Cliente" para come√ßar a gerenciar sua carteira.</p>
  </div>
</ng-template>
