<div class="page-header">
  <h2 class="page-title">ðŸ‘¥ Gerenciamento de Clientes</h2>
  <button mat-raised-button color="primary" routerLink="/clientes/new">
    <mat-icon>person_add</mat-icon>
    Novo Cliente
  </button>
</div>

<ng-container *ngIf="customers.length > 0; else noClients">
  <div class="customer-grid">
    <mat-card *ngFor="let c of customers; trackBy: trackByCustomer" class="client-card" role="group" aria-label="Card do cliente {{c.nome}}">
  <mat-card-header>
    <mat-icon mat-card-avatar color="primary" aria-hidden="true">account_circle</mat-icon>
    <div class="header-text">
      <mat-card-title>{{ c.nome }}</mat-card-title>
      <mat-card-subtitle>{{ c.email }}</mat-card-subtitle>
    </div>

    <!-- Delete icon isolated com tooltip e confirmaÃ§Ã£o -->
    <button mat-icon-button color="warn"
            class="action-delete"
            (click)="openDeleteDialog(c.id, c.nome)"
            aria-label="Excluir {{c.nome}}"
            matTooltip="Excluir cliente">
      <mat-icon>delete</mat-icon>
    </button>
  </mat-card-header>

  <mat-card-content>
    <!-- Saldo: label sutil + valor (com opÃ§Ã£o de ocultar) -->
    <div class="saldo-detailed" [attr.aria-label]="'Saldo disponÃ­vel: R$ ' + (c.saldo | number:'1.2-2')">
      <div class="saldo-head">
        <div class="saldo-label">Saldo disponÃ­vel</div>

        <!-- Toggle de visibilidade do saldo (acessÃ­vel) -->
        <button mat-icon-button class="toggle-saldo" (click)="c.saldoOculto = !c.saldoOculto"
                [attr.aria-pressed]="c.saldoOculto" aria-label="Alternar visibilidade do saldo"
                matTooltip="Mostrar/ocultar saldo">
          <mat-icon>{{ c.saldoOculto ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </div>

      <div class="saldo-value" [ngClass]="{'negative': c.saldo < 0}">
        <!-- exibe valor ou mask -->
        <ng-container *ngIf="!c.saldoOculto; else masked">
          R$ {{ c.saldo | number:'1.2-2' }}
        </ng-container>
        <ng-template #masked>R$ â€¢â€¢â€¢â€¢,â€¢â€¢</ng-template>
      </div>

      <!-- Pequenho rodapÃ© com info (opcional) -->
      <div class="saldo-meta" *ngIf="c.saldoUpdatedAt">
        Atualizado em {{ c.saldoUpdatedAt | date:'dd/MM/yyyy HH:mm' }}
      </div>
    </div>
  </mat-card-content>

  <mat-card-actions class="card-actions">
    <button mat-stroked-button color="accent" [routerLink]="['/clientes', c.id, 'edit']" aria-label="Editar {{c.nome}}" matTooltip="Editar cliente">
      <mat-icon>edit</mat-icon>
      Editar
    </button>

    <button mat-stroked-button class="action-deposit" [routerLink]="['/clientes', c.id, 'deposit']" aria-label="Depositar em {{c.nome}}" matTooltip="Depositar">
      <mat-icon>arrow_downward</mat-icon>
      Depositar
    </button>

    <button mat-stroked-button class="action-withdraw" [routerLink]="['/clientes', c.id, 'withdraw']" aria-label="Sacar de {{c.nome}}" matTooltip="Sacar">
      <mat-icon>arrow_upward</mat-icon>
      Sacar
    </button>
  </mat-card-actions>
</mat-card>

  </div>
</ng-container>

<ng-template #noClients>
  <div class="empty-state">
    <mat-icon class="empty-state-icon">people_outline</mat-icon>
    <h2>Nenhum cliente cadastrado</h2>
    <p>Clique em "Novo Cliente" para comeÃ§ar a gerenciar sua carteira.</p>
  </div>
</ng-template>
